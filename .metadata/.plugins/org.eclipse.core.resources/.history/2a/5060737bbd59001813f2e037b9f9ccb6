package Controller;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;

public class FicheroController {

	private static FicheroController controller;
	private final int BUFFER_SIZE = 500;
	
	private FicheroController() {}
	
	public int[] leer() {
		int[] array = new int[10];
		try {
			InputStream ficheroEntrada = new FileInputStream(new File("puntuaciones.pn"));
			byte[] buf = new byte[BUFFER_SIZE];
			int cantidadLeida;
			int aux = 0;
			String numero = "";
			while ((cantidadLeida = ficheroEntrada.read(buf, 0, BUFFER_SIZE)) > 0) {
				for (int i = 0; i < cantidadLeida; i++) {
					if(buf[i] != '\n') {
						numero += (buf[i]-48);
					} else {
						array[aux] = Integer.parseInt(numero);
						numero = "";
						aux++;
					}
				}
			}
			if(!numero.equals("")) {
				array[aux] = Integer.parseInt(numero);
			}
			ficheroEntrada.close();
		} catch (Exception errorDeFichero) {
			System.out.println("Ha habido problemas: " + errorDeFichero.getMessage());
		}
		return array;
	}
	
	public void escribir(String num) {
		try {
			byte[] buf = new byte[num.length()];
			int i = 0;
			for (i = 0; i < num.length(); i++) {
				buf[i] = (byte) num.charAt(i);
			}
			OutputStream ficheroSalida = new FileOutputStream(new File("puntuaciones.pn"), true);
			
			ficheroSalida.write(buf, 0, i);
			ficheroSalida.write('\n');
			
			ficheroSalida.close();
		} catch (Exception e) {
			// TODO: handle exception
		}
	}

	public static FicheroController getInstance() {
		if (controller != null) {
			return controller;
		} else {
			controller = new FicheroController();
			return controller;
		}
	}

	public static void setController(FicheroController controller) {
		FicheroController.controller = controller;
	}
	
}

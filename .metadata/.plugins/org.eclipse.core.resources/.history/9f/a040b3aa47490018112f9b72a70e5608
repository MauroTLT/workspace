

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;

import javax.swing.JButton;
import javax.swing.JList;

public class Controlador implements ActionListener, MouseListener, KeyListener {
	private Modelo modelo;
	private Vista vista;
	private ControladorFichero cf;
	private String nombreArchivo;
	public Controlador() {
		super();
		nombreArchivo="historico.txt";
		this.modelo = new Modelo();
		cf=new ControladorFichero(nombreArchivo,modelo.getModelo());
		this.vista = new Vista(modelo.getModelo());
		organizar();
	}

	private void organizar() {
		this.vista.getBorrar().addActionListener(this);
		this.vista.getNuevo().addActionListener(this);
		this.vista.getLimpiarLista().addActionListener(this);
		this.vista.getLista().addMouseListener(this);
		this.vista.getTxt().addKeyListener(this);
	}

	public Modelo getModelo() {
		return modelo;
	}

	public void setModelo(Modelo modelo) {
		this.modelo = modelo;
	}

	public Vista getVista() {
		return vista;
	}

	public void setVista(Vista vista) {
		this.vista = vista;
	}

	@Override
	public void keyPressed(KeyEvent e) {
		if (e.getKeyCode() == KeyEvent.VK_ENTER && vista.getTxt().getText().length() > 0) {
			modelo.agregar(vista.getTxt().getText());
			vista.getTxt().setText("");
		}

	}

	@Override
	public void keyReleased(KeyEvent arg0) {
		// TODO Auto-generated method stub

	}

	@Override
	public void keyTyped(KeyEvent arg0) {
		// TODO Auto-generated method stub

	}

	@Override
	public void mouseClicked(MouseEvent e) {
		@SuppressWarnings("unchecked")
		JList<String> ext = (JList<String>) e.getSource();
		vista.getTxt().setText(ext.getSelectedValue());
	}

	@Override
	public void mouseEntered(MouseEvent arg0) {
		// TODO Auto-generated method stub

	}

	@Override
	public void mouseExited(MouseEvent arg0) {
		// TODO Auto-generated method stub

	}

	@Override
	public void mousePressed(MouseEvent arg0) {
		// TODO Auto-generated method stub

	}

	@Override
	public void mouseReleased(MouseEvent arg0) {
		// TODO Auto-generated method stub

	}

	@Override
	public void actionPerformed(ActionEvent e) {
		JButton ext = (JButton) e.getSource();
		switch (ext.getText()) {
		case "agregar":
			if (vista.getTxt().getText().length() > 0){
				modelo.agregar(vista.getTxt().getText());
				cf.guardarInformacion(vista.getTxt().getText());
			}	
			vista.getTxt().setText("");
			break;
		case "borrar":
			if (vista.getTxt().getText().length() > 0){
				cf.borrarLinea(this.vista.getLista().getSelectedValue());
				modelo.eliminar(vista.getTxt().getText());
			}
			vista.getTxt().setText("");
			break;
		case "vaciar lista":
			modelo.vaciar();
			cf.borrarArchivo();
		}

	}
}

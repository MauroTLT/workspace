package FireEmblem;

import java.util.Scanner;

public class Main {
	static Jugador j1 = new Jugador("Mauro");
	static Jugador j2 = new Jugador("Topo");
	
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		Scanner entradaTeclado = new Scanner(System.in);
		int turno = 0;
		
		Arma espada = new Arma("Espada", null, null);
		Arma lanza = new Arma("Lanza", espada, null);
		Arma hacha = new Arma("Hacha", lanza, espada);
		
		espada.setVentaja(hacha);
		espada.setDesventaja(lanza);
		lanza.setDesventaja(hacha);
		
		Casilla a = new Casilla("Arboleda", false, "♣");
		Casilla m = new Casilla("Montaña", false, "■");
		Casilla p = new Casilla("Planicie", false, " ");
		Casilla[][] t1 = new Casilla[][]
				{
					{new Casilla(p,0,0), new Casilla(p,0,1), new Casilla(p,0,2), new Casilla(p,0,3), new Casilla(p,0,4), new Casilla(p,0,5)},
					{new Casilla(p,1,0), new Casilla(p,1,1), new Casilla(p,1,2), new Casilla(m,1,3), new Casilla(a,1,4), new Casilla(p,1,5)},
					{new Casilla(p,2,0), new Casilla(a,2,1), new Casilla(m,2,2), new Casilla(m,2,3), new Casilla(p,2,4), new Casilla(p,2,5)},
					{new Casilla(p,3,0), new Casilla(p,3,1), new Casilla(m,3,2), new Casilla(m,3,3), new Casilla(p,3,4), new Casilla(p,3,5)},
					{new Casilla(p,4,0), new Casilla(p,4,1), new Casilla(m,4,2), new Casilla(m,4,3), new Casilla(a,4,4), new Casilla(p,4,5)},
					{new Casilla(p,5,0), new Casilla(a,5,1), new Casilla(m,5,2), new Casilla(m,5,3), new Casilla(p,5,4), new Casilla(p,5,5)},
					{new Casilla(p,6,0), new Casilla(p,6,1), new Casilla(m,6,2), new Casilla(a,6,3), new Casilla(p,6,4), new Casilla(p,6,5)},
					{new Casilla(p,7,0), new Casilla(p,7,1), new Casilla(p,7,2), new Casilla(p,7,3), new Casilla(p,7,4), new Casilla(a,7,5)}
				};
		Tablero tablero1 = new Tablero("Arena 1", t1);
		
		Personaje p1 = new Volador("Subaki", lanza, 0, 25, 25, tablero1.getMapa()[0][0], "♝");
		Personaje p2 = new Infanteria("Marth", espada, 0, 30, 20, tablero1.getMapa()[1][0], "♜");
		Personaje p3 = new Infanteria("Ike", espada, 0, 40, 5, tablero1.getMapa()[7][0], "♛");
		Personaje p4 = new Caballeria("Frederick", hacha, 0, 30, 15, tablero1.getMapa()[6][0], "♞");
		j1.aniadir(p1); j1.aniadir(p2); j1.aniadir(p3); j1.aniadir(p4);
		
		Personaje p5 = new Volador("Cordelia", hacha, 0, 20, 25, tablero1.getMapa()[1][5], "♗");
		Personaje p6 = new Infanteria("Daraen", espada, 0, 30, 20, tablero1.getMapa()[2][5], "♖");
		Personaje p7 = new Infanteria("Azura", lanza, 0, 40, 5, tablero1.getMapa()[5][5], "♕");
		Personaje p8 = new Caballeria("Abel", espada, 0, 30, 15, tablero1.getMapa()[6][5], "♘");
		j2.aniadir(p5); j2.aniadir(p6); j2.aniadir(p7); j2.aniadir(p8);

		tablero1.getMapa()[0][0].setPersonaje(p1);
		tablero1.getMapa()[1][0].setPersonaje(p2);
		tablero1.getMapa()[7][0].setPersonaje(p3);
		tablero1.getMapa()[6][0].setPersonaje(p4);
		tablero1.getMapa()[1][5].setPersonaje(p5);
		tablero1.getMapa()[2][5].setPersonaje(p6);
		tablero1.getMapa()[5][5].setPersonaje(p7);
		tablero1.getMapa()[6][5].setPersonaje(p8);
		
		menu(entradaTeclado, tablero1, turno);
	}
	
	public static void menu(Scanner entradaTeclado, Tablero tablero1, int turno) {
		Personaje per;
		String personaje = "";
		boolean semaforo = false;
		int fila = 0;
		int columna = 0;
		if(turno % 2 == 0) {
			System.out.println("\nTurno de " + j1.getNombre());
		} else {
			System.out.println("\nTurno de " + j2.getNombre());
		}
		System.out.println("1.Mover\t\t2.Visualizar Personaje\t\t3.Visualizar lista\t\t4.Visualizar Casilla\t5.Mapa");
		switch(entradaTeclado.next()) {
		case "1":
			if(turno % 2 == 0) {
				System.out.println("Elige un personaje\n");
				for(int i = 0; i< j1.getPersonajes().length; i++) {
					if(j1.getPersonajes()[i].getHp() != 0) {
						System.out.print((i + 1) + "." + j1.getPersonajes()[i].getNombre() + "  |  ");
					} else {System.out.print((i + 1) + ".K.O  |  ");}
				}
				while(!entradaTeclado.hasNextInt() && entradaTeclado.nextInt() > 4) {
					System.out.println("Formato Incorrecto");
					entradaTeclado.next();
				}
				per = j1.getPersonajes()[entradaTeclado.nextInt() - 1];
			} else {
				System.out.println("Elige un personaje\n");
				for(int i = 0; i< j2.getPersonajes().length; i++) {
					if(j2.getPersonajes()[i].getHp() != 0) {
						System.out.print((i + 1) + "." + j2.getPersonajes()[i].getNombre() + "  |  ");
					} else {System.out.print((i + 1) + ".K.O  |  ");}
				}
				while(!entradaTeclado.hasNextInt()) {
					System.out.println("Formato Incorrecto");
					entradaTeclado.next();
				}
				per = j2.getPersonajes()[entradaTeclado.nextInt() - 1];
			}
			if(per.getHp() == 0) {
				System.out.println("Personaje derrotado elige otro");
				menu(entradaTeclado, tablero1, turno);
			}
			per.mover(entradaTeclado, tablero1);
			tablero1.visualizar();
			System.out.println("¿Atacar? \nEscribir Si para atacar, cualquier otra cosa se considerará como No");
			if(entradaTeclado.next().equalsIgnoreCase("Si")) {
				per.atacar(entradaTeclado, tablero1);
			}
			turno++;
			break;
		case "2":
			System.out.println("¿Que personaje?");
			System.out.println("\nLista de " + j1.getNombre());
			System.out.print("  |  ");
			for(int i = 0; i < j1.getPersonajes().length; i++) {
				if(j1.getPersonajes()[i].getHp() != 0) {
					System.out.print(j1.getPersonajes()[i].getNombre() + "  |  ");
				}
			}
			System.out.println("\n\nLista de " + j2.getNombre());
			System.out.print("  |  ");
			for(int i = 0; i < j2.getPersonajes().length; i++) {
				if(j2.getPersonajes()[i].getHp() != 0) {
					System.out.print(j2.getPersonajes()[i].getNombre() + "  |  ");
				}
			}
			System.out.println();
			personaje = entradaTeclado.next();
			for(int i = 0; i < j1.getPersonajes().length && !semaforo; i++) {
				if(j1.getPersonajes()[i].getNombre().equalsIgnoreCase(personaje)) {
					System.out.println("\n" + j1.getPersonajes()[i].toString());
					if(j1.getPersonajes()[i].getHp() == 0) {
						System.out.println("Personaje derrotado");
					}
					semaforo = true;
				} else if(j2.getPersonajes()[i].getNombre().equalsIgnoreCase(personaje)) {
					System.out.println("\n" + j2.getPersonajes()[i].toString());
					if(j2.getPersonajes()[i].getHp() == 0) {
						System.out.println("Personaje derrotado");
					}
					semaforo = true;
				} else if(i == j1.getPersonajes().length && !semaforo) {
					System.out.println("Personaje no encontrado");
				}
			}
			
			break;
		case "3":
			if(turno % 2 == 0) {
				System.out.println("\nLista de " + j1.getNombre());
				for(int i = 0; i < j1.getPersonajes().length; i++) {
					System.out.print("\n" + j1.getPersonajes()[i].toString());
					if(j1.getPersonajes()[i].getHp() == 0) {
						System.out.print(" Personaje derrotado");
					}
				}
			} else {
				System.out.println("\nLista de " + j2.getNombre());
				for(int i = 0; i < j2.getPersonajes().length; i++) {
					System.out.print("\n" + j2.getPersonajes()[i].toString());
					if(j2.getPersonajes()[i].getHp() == 0) {
						System.out.print(" Personaje derrotado");
					}
				}
			}
			break;
		case "4":
			System.out.println("Fila: ");
			fila = entradaTeclado.nextInt();
			System.out.println("Columna: ");
			columna = entradaTeclado.nextInt();
			tablero1.getMapa()[fila][columna].visualizar();
			break;
		case "5":
			tablero1.visualizar();
			break;
		default:
			System.out.println("Orden incorrecta");
		}
		System.out.println();
		if(gameOver()) {
			System.out.println("Finalizando programa");
		} else {menu(entradaTeclado, tablero1, turno);}
	}
	
	public static boolean gameOver() {
		if(j1.getPersonajes() == null) {
			System.out.println("\nEl ganador es" + j2.getNombre());
			return true;
		} else if(j2.getPersonajes() == null) {
			System.out.println("\nEl ganador es" + j1.getNombre());
			return true;
		} else {return false;}
	}

}